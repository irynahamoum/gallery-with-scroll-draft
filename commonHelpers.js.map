{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst galleryGrid = document.querySelector('.gallery-grid');\nconst loader = document.querySelector('.loader');\n// const loadMoreBtn = document.querySelector('.js-load-more-btn');\nconst target = document.querySelector('.js-target');\nlet gallery = new SimpleLightbox('.gallery-grid a', {\n  captionsData: 'alt',\n});\n\nconst BASE_URL = 'https://pixabay.com/api/';\nlet page = 1;\nlet inputValue;\n\nlet totalPages = 0;\n\nform.addEventListener('submit', handleFormSubmit);\n\n// loadMoreBtn.addEventListener('click', handleLoadBtnClick);\n\nconst onEntry = (entries, observer) => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) loadMore();\n  });\n};\n\nconst observer = new IntersectionObserver(onEntry);\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  unObserveElement();\n\n  galleryGrid.innerHTML = '';\n\n  inputValue = event.target.elements.query.value.trim();\n\n  if (!inputValue) {\n    galleryGrid.innerHTML = '';\n    iziToast.error({\n      message: 'Search field is empty',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  showLoader();\n\n  try {\n    page = 1;\n    const data = await getImagesByInputValue();\n    if (data?.hits?.length) {\n      hideLoader();\n      totalPages = Math.ceil(data.totalHits / 15);\n      checkLoadBtnStatus();\n      createMarkupByHits(data.hits);\n\n      return;\n    }\n    throw Error(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  } catch (error) {\n    iziToast.info({\n      message:\n        typeof error === 'string' ? error : 'Something went wrong, sorry!',\n      position: 'topRight',\n    });\n  }\n\n  event.target.reset();\n}\n\nasync function loadMore() {\n  showLoader();\n  unObserveElement();\n\n  try {\n    page += 1;\n\n    const data = await getImagesByInputValue();\n    if (data?.hits?.length) {\n      hideLoader();\n      checkLoadBtnStatus();\n      createMarkupByHits(data.hits);\n      const cardHeight = document\n        .querySelector('.gallery-card')\n        .getBoundingClientRect().height;\n      scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n      return;\n    }\n    throw Error(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  } catch (error) {\n    iziToast.info({\n      message:\n        typeof error === 'string' ? error : 'Something went wrong, sorry!',\n      position: 'topRight',\n    });\n  }\n}\n\nfunction checkLoadBtnStatus() {\n  if (totalPages !== page) {\n    observeElement();\n  } else {\n    unObserveElement();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n  }\n}\n\nfunction showLoader() {\n  loader.style.display = 'inline-block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction observeElement() {\n  observer.observe(target);\n}\n\nfunction unObserveElement() {\n  observer.unobserve(target);\n}\n\nasync function getImagesByInputValue() {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '42157668-d969611c6fdd34526589fe987',\n      q: inputValue,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safeSearch: true,\n      page: page,\n      per_page: 15,\n    },\n  });\n  return response.data;\n}\n\nfunction createMarkupByHits(hits) {\n  const galleryItem = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a href=\"${largeImageURL}\" class=\"gallery-card\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" >\n      <div class=\"img-details-box\">\n      <p class=\"detail-item\"><b>Likes:</b> ${likes}</p>\n      <p class=\"detail-item\"><b>Views:</b> ${views}</p>\n      <p class=\"detail-item\"><b>Comments:</b> ${comments}</p>\n      <p class=\"detail-item\"><b>Downloads:</b> ${downloads}</p></div>\n      </a>`;\n      }\n    )\n    .join('');\n\n  galleryGrid.insertAdjacentHTML('beforeend', galleryItem);\n\n  gallery.refresh();\n}\n"],"names":["form","galleryGrid","loader","target","gallery","SimpleLightbox","page","inputValue","totalPages","handleFormSubmit","onEntry","entries","observer","entry","loadMore","event","unObserveElement","iziToast","showLoader","data","getImagesByInputValue","_a","hideLoader","checkLoadBtnStatus","createMarkupByHits","error","cardHeight","observeElement","axios","hits","galleryItem","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}